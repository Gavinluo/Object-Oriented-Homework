@startuml
title UC10 查看预约统计报表 活动图

|管理员|
start
:进入“统计报表”页面;
:选择时间范围、校区、房间类型\n是否包含违约数据等条件;
:点击“生成报表”;

|统计报表模块|
:校验统计条件\n(时间范围是否合法等);
if (条件合法?) then (是)
else (否)
  |管理员|
  :提示“请检查时间范围等\n统计条件是否正确”;
  stop
endif

:从预约管理子系统\n读取符合条件的预约记录;

|预约管理子系统|
:返回预约数据集;

|统计报表模块|
:从场地资源管理子系统\n读取房间信息(类型、容量等);

|场地资源管理子系统|
:返回房间信息数据集;

|统计报表模块|
:根据预约数据和房间信息\n计算各项统计指标;
:生成表格和图表数据;

|管理员|
:在页面中查看统计结果\n(使用率、违约率、平均时长等);

if (管理员选择导出报表?) then (是)
  |统计报表模块|
  :生成导出文件\n(Excel/PDF等);
  if (导出成功?) then (是)
    |管理员|
    :下载报表文件成功;
  else (否)
    |管理员|
    :提示“报表导出失败\n请稍后重试”;
  endif
else (否)
  ' 仅查看不导出
endif

stop
@enduml
