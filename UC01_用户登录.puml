@startuml
title UC01 用户登录 活动图

|用户|
start
:打开登录页面;
:输入账号和密码;
:点击“登录”;

|登录/认证模块|
:校验输入格式\n(非空、长度等);
if (格式合法?) then (是)
else (否)
  :提示“请输入正确的账号和密码”;
  :记录输入错误日志;
  stop
endif

:向统一认证系统\n或本地认证模块发送认证请求;

|统一认证系统|
:校验账号和密码;
if (认证通过?) then (是)
  :返回用户身份信息\n(学生/教职工/管理员);
else (否)
  :返回认证失败结果\n(账号不存在/密码错误等);
endif

|登录/认证模块|
if (认证通过?) then (是)
  :检查账户状态\n(是否锁定/停用);
  if (账户正常?) then (是)
    :创建用户会话;
    :记录登录时间和IP;
    |用户|
    :显示登录成功页面\n并跳转到相应首页;
    stop
  else (否)
    :提示“账号状态异常\n请联系管理员”;
    :记录安全事件日志;
    stop
  endif
else (否)
  :增加该账号登录失败次数;
  if (失败次数 >= 5?) then (是)
    :锁定账号30分钟;
    :记录账号锁定日志;
  endif
  |用户|
  :提示“账号或密码错误”;
  stop
endif

@enduml
