@startuml
title UC03 查询可预约时间段 活动图

|用户|
start
:进入“自习室/讨论室预约”页面;
:选择校区、房间、日期;
:点击“查询可预约时间段”;

|预约查询模块|
:校验查询条件\n(房间、日期是否为空);
if (条件合法?) then (是)
else (否)
  |用户|
  :提示“请完整选择校区、房间和日期”;
  stop
endif

:检查日期是否早于当前日期;
if (日期有效?) then (是)
else (否)
  |用户|
  :提示“日期不能早于当前日期”;
  stop
endif

:从场地资源管理子系统\n读取该房间在指定日期的\n基础可用时间段;

|场地资源管理子系统|
:返回基础可用时间段\n及房间状态(是否维护/停用);

|预约查询模块|
if (房间当日可用?) then (是)
  :从预约管理子系统\n查询该房间当日已预约时间段;
  |预约管理子系统|
  :返回已占用时间段列表;
  |预约查询模块|
  :根据基础可用时间段\n扣除已占用和维护时间段\n计算可预约时间段列表;
  if (存在可预约时间段?) then (是)
    |用户|
    :展示可预约时间段列表\n按时间顺序显示;
    stop
  else (否)
    |用户|
    :提示“该房间在所选日期\n已无可预约时间段”;
    stop
  endif
else (否)
  |用户|
  :提示“该房间在所选日期不可预约”;
  stop
endif

@enduml
