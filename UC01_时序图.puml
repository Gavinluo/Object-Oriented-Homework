@startuml
title UC01 用户登录 时序图

actor UserActor as U
boundary LoginPage as B
control AuthController as C
participant AuthService as S
participant SSOClient as SSO
participant SessionManager as SM

U -> B: 输入账号、密码\n点击“登录”
B -> C: login(account, password)

C -> S: authenticate(account, password)
S -> SSO: ssoAuthenticate(account, password)
SSO --> S: 认证结果

alt 认证成功
  S --> C: 返回 User
  C -> SM: createSession(user)
  SM --> C: sessionId
  C --> B: 登录成功\n返回首页与角色信息
  B --> U: 显示登录成功页面
else 认证失败
  S -> S: increaseFailedCount(account)
  alt 连续失败次数>=5
    S -> S: lockUser(account)
  end
  S --> C: 认证失败
  C --> B: 登录失败消息
  B --> U: 提示“账号或密码错误\n或账号被锁定”
end

@enduml
